DROP DATABASE IF EXISTS 도서관리_DB;
DROP USER IF EXISTS igh05001@localhost;

CREATE USER  igh05001@localhost IDENTIFIED WITH mysql_native_password BY  'qwer1234!';
GRANT ALL PRIVILEGES ON 도서관리_DB.* TO igh05001@localhost WITH GRANT OPTION;
-- DB 생성
CREATE DATABASE IF NOT EXISTS 도서관리_DB;
USE 도서관리_DB;

CREATE TABLE 회원정보(
	회원번호 VARCHAR(5) PRIMARY KEY NOT NULL,
    회원이름 VARCHAR(20) NOT NULL,
    주소 VARCHAR(50) NOT NULL,
    전화번호 VARCHAR(20) NOT NULL UNIQUE
);

CREATE TABLE 주문회원(
	주문번호 VARCHAR(11) PRIMARY KEY NOT NULL,
    주문날짜 DATE,
    회원번호 VARCHAR(5) NOT NULL,
    FOREIGN KEY(회원번호) REFERENCES 회원정보(회원번호)
);

CREATE TABLE 도서정보(
	도서시리얼넘버 VARCHAR(8) NOT NULL,
    도서명 VARCHAR(50) NOT NULL,
    PRIMARY KEY(도서시리얼넘버)
);

CREATE TABLE 판매정보(
	주문번호 VARCHAR(11) NOT NULL,
    회원번호 VARCHAR(5) NOT NULL,
    도서시리얼넘버 VARCHAR(8) NOT NULL,
    수량 INT,
    단가 INT,
    PRIMARY KEY(주문번호),
    FOREIGN KEY(주문번호) REFERENCES 주문회원(주문번호),
    FOREIGN KEY(회원번호) REFERENCES 회원정보(회원번호),
    FOREIGN KEY(도서시리얼넘버) REFERENCES 도서정보(도서시리얼넘버)
);

-- 삽입
DELETE FROM 판매정보;
DELETE FROM 도서정보;
DELETE FROM 주문회원;
DELETE FROM 회원정보;

INSERT INTO 회원정보 VALUE('10001','오민혁','가석로','010-3789-8504');
INSERT INTO 회원정보 VALUE('10002','오민지','충무로','010-3789-8505');
INSERT INTO 회원정보 VALUE('10003','오동지','충무김밥','010-3789-8506');
INSERT INTO 회원정보 VALUE('10004','오로롱','충충충','010-3789-8507');
INSERT INTO 회원정보 VALUE('10005','오호호','충성','010-3789-8508');

INSERT INTO 도서정보 VALUE('12345678','HTML1');
INSERT INTO 도서정보 VALUE('12345679','HTML2');
INSERT INTO 도서정보 VALUE('12345608','HTML3');
INSERT INTO 도서정보 VALUE('12345578','HTML4');
INSERT INTO 도서정보 VALUE('12344678','HTML5');
INSERT INTO 도서정보 VALUE('12343678','HTML6');
INSERT INTO 도서정보 VALUE('12342678','HTML7');
INSERT INTO 도서정보 VALUE('12341678','HTML8');
INSERT INTO 도서정보 VALUE('12340678','HTML9');
INSERT INTO 도서정보 VALUE('12302678','HTML0');

INSERT INTO 주문회원 VALUE('00000000001','2022-03-16','10001');
INSERT INTO 주문회원 VALUE('00000000002','2022-03-16','10002');
INSERT INTO 주문회원 VALUE('00000000003','2022-03-16','10003');
INSERT INTO 주문회원 VALUE('00000000004','2022-03-16','10004');
INSERT INTO 주문회원 VALUE('00000000005','2022-03-16','10005');
INSERT INTO 주문회원 VALUE('00000000006','2022-03-16','10001');


INSERT INTO 판매정보 VALUE('00000000001','10001','12345678','1','15000');
INSERT INTO 판매정보 VALUE('00000000002','10002','12345679','1','30000');
INSERT INTO 판매정보 VALUE('00000000003','10002','12345608','1','15000');
INSERT INTO 판매정보 VALUE('00000000004','10003','12345578','1','15000');
INSERT INTO 판매정보 VALUE('00000000005','10004','12344678','1','15000');
INSERT INTO 판매정보 VALUE('00000000006','10005','12343678','1','15000');

-- 자료 조회회원번호PRIMARY
-- SELECT * FROM 회원번호;

-- 변경
Select * from 판매정보;
UPDATE 판매정보 SET 단가=30000 WHERE 도서시리얼넘버 = '00005678';
Select * from 판매정보;
-- 삭제
Select * from 판매정보;
DELETE FROM 판매정보 WHERE 수량=0 OR 단가=0 OR 수량 IS NULL OR 단가 IS NULL;
Select * from 판매정보;